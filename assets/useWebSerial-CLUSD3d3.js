import{p as e,m as a}from"./Footer-CqatApVj.js";const s=new Worker(new URL(""+new URL("worker-Bz7w5ZvW.js",import.meta.url).href,import.meta.url));function t(t,n){const r=a([]),o=a(!1),u=a(!1),l=a(!1),d=a(!0),c=a(!1),i=a(""),v=a([]),_=a(null),p=a(0),g=a(0),m=a(0),w=a(""),b=a(""),f=a(0),k=a(""),M=a(""),h=a(""),y=a(1),I=a(0),P=a(0),x=a(0),V=a(0),q=a([]),L=a(0),U=a(0),A=7071,C=62208;let j=0;function B(e){r.value.push({date:new Date,error:e})}function D(e){r.value.push({date:new Date,event:e})}function E(e){let a=null;return e&&(a=++j),a}return s.addEventListener("message",e=>function(e){switch(e.event){case"connected":o.value=!1,u.value=!0,D("Port connected."),I.value=1;break;case"disconnected":u.value=!1,D("Port disconnected."),v.value=[],I.value=-1,o.value=!1;break;case"isTalking":c.value=e.value;break;case"version":_.value=e.value;break;case"ConnectFailed":const P=e.message.indexOf(":");let U=e.message;-1!==P&&(U=e.message.substring(0,P)),alert(U),I.value=-2,o.value=!1;break;case"eraseall_status_dms":p.value=e.value;break;case"eraseall_vid_dms":g.value=e.value;break;case"update_driver_status":m.value=e.value;break;case"driver_ver_msg":w.value=e.value;break;case"device_name_msg":b.value=e.value;break;case"update_driver_path_msg":k.value=e.value;break;case"clone_fw_dev":V.value=e.value;break;case"clone_fw_status":x.value=e.value;break;case"progress_percent":f.value=e.value;break;case"progress_body_text":case"progress_title_text":M.value=e.value;break;case"add_device_chain":a=e.address,s=e.name,t=e.firmwareVersion,n=e.image,r=e.detail,l=e.dl_mode,d=e.parent_address,i=e.pid,h=e.order,y=e.host_deep,q.value.push({address:a,name:s,firmwareVersion:t,image:n,detail:r,dl_mode:l,parent_address:d,pid:i,order:h,host_deep:y});break;case"add_device_chain_status":L.value=e.value}var a,s,t,n,r,l,d,i,h,y}(e.data)),s.addEventListener("error",e=>{s.terminate()}),e(()=>i.value,e=>{""===e&&s.postMessage({task:"clearOutput"})}),{history:r,isBusy:o,isConnected:u,isPlaying:l,isStopped:d,isTalking:c,log:i,regions:v,version:_,eraseall_status_dms:p,eraseall_vid_dms:g,update_driver_status:m,driver_ver:w,device_name:b,progress_percent:f,update_driver_path:k,update_devaddr:y,connect_status:I,connection_mode:P,clone_fw_status:x,clone_fw_dev:V,progress_body_text:M,progress_title_text:h,devicesChainList:q,add_device_chain_status:L,connect_dl_mb:U,connect:async function(){!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),o.value=!0;try{0!=U.value?(U.value=0,await navigator.serial.requestPort({filters:[{usbVendorId:A,usbProductId:C},{usbVendorId:A,usbProductId:62209}]})):await navigator.serial.requestPort({filters:[{usbVendorId:A,usbProductId:C}]})}catch(e){return B(e?.message||"Unable to request port."),o.value=!1,0}return s.postMessage({task:"connect",value:y.value}),1},disconnect:async function(){s.postMessage({task:"disconnect"})},execute:function(e){s.postMessage({task:"execute",line:e})},list:function(e=null){s.postMessage({task:"list",callbackId:E(e)})},listAll:function(){s.postMessage({task:"listAll"})},newAll:function(){s.postMessage({task:"newAll"})},play:function(){s.postMessage({task:"play"})},record:function(e){s.postMessage({task:"record",lines:e})},region:function(e){s.postMessage({task:"region",index:e})},stop:function(){s.postMessage({task:"stop"})},eraseall_dms_execute:async function(){!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),o.value=!0,s.postMessage({task:"eraseall_dms_execute_msg"})},eraseall_dms_connect:async function(){if(!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),0==u.value){try{await navigator.serial.requestPort({filters:[{usbVendorId:A,usbProductId:C},{usbVendorId:A,usbProductId:62209}]})}catch(e){return B(e?.message||"Unable to request port."),void(p.value=1)}s.postMessage({task:"eraseall_dms_connect_msg",value:y.value})}else p.value=1},driver_connect:async function(){if(!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),0==u.value){try{await navigator.serial.requestPort({filters:[{usbVendorId:A,usbProductId:C}]})}catch(e){return B(e?.message||"Unable to request port."),m.value=-1,0}s.postMessage({task:"driver_connect_msg",value:y.value}),m.value=1}else m.value=1;return 1},driver_update:async function(){1==u.value&&s.postMessage({task:"driver_connect_updadate_msg"})},sendescape:async function(){1==u.value&&s.postMessage({task:"sendescape"})},do_clone_fw:async function(e,a){1==u.value&&s.postMessage({task:"do_clone_fw",value1:e,value2:a})},do_discover:async function(){1==u.value&&(q.value=[],s.postMessage({task:"do_discover"}))}}}export{t as u};
