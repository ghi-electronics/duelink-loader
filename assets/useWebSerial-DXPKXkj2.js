import{r as e,l as a}from"./_plugin-vue_export-helper-BX9q4kgD.js";const s=""+new URL("../img/stamp-usb-connect.webp",import.meta.url).href,t=""+new URL("../img/console-connect-com.webp",import.meta.url).href,n=""+new URL("../img/console-connect-dfu.webp",import.meta.url).href,o=new Worker(new URL(""+new URL("worker-BJDRWnAN.js",import.meta.url).href,import.meta.url));function r(s,t){const n=e([]),r=e(!1),u=e(!1),l=e(!1),c=e(!0),i=e(!1),d=e(""),v=e([]),p=e(null),_=e(0),g=e(0),m=e(0),w=e(""),f=e(""),b=e(0),k=e(""),M=e(""),h=e(""),y=e(1),x=e(0),P=e(0),I=e(0),U=e(0),L=7071,q=62208;let R=0;function A(e){n.value.push({date:new Date,error:e})}function V(e){n.value.push({date:new Date,event:e})}function D(e){let a=null;return e&&(a=++R),a}return o.addEventListener("message",e=>function(e){switch(e.event){case"connected":r.value=!1,u.value=!0,V("Port connected."),x.value=1;break;case"disconnected":u.value=!1,V("Port disconnected."),v.value=[],x.value=-1,r.value=!1;break;case"isTalking":i.value=e.value;break;case"version":p.value=e.value;break;case"ConnectFailed":const a=e.message.indexOf(":");let s=e.message;-1!==a&&(s=e.message.substring(0,a)),alert(s),x.value=-2,r.value=!1;break;case"eraseall_status_dms":_.value=e.value;break;case"eraseall_vid_dms":g.value=e.value;break;case"update_driver_status":m.value=e.value;break;case"driver_ver_msg":w.value=e.value;break;case"device_name_msg":f.value=e.value;break;case"update_driver_path_msg":k.value=e.value;break;case"clone_fw_dev":U.value=e.value;break;case"clone_fw_status":I.value=e.value;break;case"progress_percent":b.value=e.value;break;case"progress_body_text":case"progress_title_text":M.value=e.value}}(e.data)),o.addEventListener("error",e=>{o.terminate()}),a(()=>d.value,e=>{""===e&&o.postMessage({task:"clearOutput"})}),{history:n,isBusy:r,isConnected:u,isPlaying:l,isStopped:c,isTalking:i,log:d,regions:v,version:p,eraseall_status_dms:_,eraseall_vid_dms:g,update_driver_status:m,driver_ver:w,device_name:f,progress_percent:b,update_driver_path:k,update_devaddr:y,connect_status:x,connection_mode:P,clone_fw_status:I,clone_fw_dev:U,progress_body_text:M,progress_title_text:h,connect:async function(){!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),r.value=!0;try{await navigator.serial.requestPort({filters:[{usbVendorId:L,usbProductId:q}]})}catch(e){return A(e?.message||"Unable to request port."),r.value=!1,0}return o.postMessage({task:"connect",value:y.value}),1},disconnect:async function(){o.postMessage({task:"disconnect"})},execute:function(e){o.postMessage({task:"execute",line:e})},list:function(e=null){o.postMessage({task:"list",callbackId:D(e)})},listAll:function(){o.postMessage({task:"listAll"})},newAll:function(){o.postMessage({task:"newAll"})},play:function(){o.postMessage({task:"play"})},record:function(e){o.postMessage({task:"record",lines:e})},region:function(e){o.postMessage({task:"region",index:e})},stop:function(){o.postMessage({task:"stop"})},eraseall_dms_execute:async function(){!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),r.value=!0,o.postMessage({task:"eraseall_dms_execute_msg"})},eraseall_dms_connect:async function(){if(!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),0==u.value){try{await navigator.serial.requestPort({filters:[{usbVendorId:L,usbProductId:q},{usbVendorId:L,usbProductId:62209}]})}catch(e){return A(e?.message||"Unable to request port."),void(_.value=1)}o.postMessage({task:"eraseall_dms_connect_msg",value:y.value})}else _.value=1},driver_connect:async function(){if(!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),0==u.value){try{await navigator.serial.requestPort({filters:[{usbVendorId:L,usbProductId:q}]})}catch(e){return A(e?.message||"Unable to request port."),m.value=-1,0}o.postMessage({task:"driver_connect_msg",value:y.value}),m.value=1}else m.value=1;return 1},driver_update:async function(){1==u.value&&o.postMessage({task:"driver_connect_updadate_msg"})},sendescape:async function(){1==u.value&&o.postMessage({task:"sendescape"})},do_clone_fw:async function(e,a){1==u.value&&o.postMessage({task:"do_clone_fw",value1:e,value2:a})}}}export{s as _,t as a,n as b,r as u};
