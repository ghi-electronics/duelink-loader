import{r as e,c as s,o as l,a,d as t,e as i,f as o,t as n,n as c,u as r,b as d}from"./runtime-dom.esm-bundler-DeyT2WUJ.js";import{m as u,u as m}from"./mitt-yoTC6CeE.js";const p={class:"page"},v={class:"button-row"},h={key:0,class:"overlay"},w={class:"dialog"},g={class:"dialog-body"},b={key:0},f={key:1},k={class:"dialog-buttons"},y={key:1,class:"overlay"},U={class:"dialog"},D={class:"dialog-body"},_={key:2,class:"overlay"},C={class:"dialog"},S={class:"dialog-buttons"},F="Firmware detected.\nAre you sure you want to erase all and enter DFU mode?";d({__name:"official",setup(d){const L=u(),E=m({progress:null},L);function B(e){return new Promise(s=>setTimeout(s,e))}e("");const x=e(!1),A=e(!1),M=e(!1),T=e(1),I=e(F);async function Y(){x.value=!1,async function(){if(E.eraseall_status_dms.value=0,0==E.isConnected.value){for(E.eraseall_vid_dms.value=0,E.connection_mode.value=2,await E.eraseall_dms_connect();0==E.eraseall_status_dms.value;)await B(100);await B(100)}if(0!=E.eraseall_vid_dms.value){let e=65535&E.eraseall_vid_dms.value;I.value=62208==e?"DUELink "+F:"MicroBlocks "+F,A.value=!0}}()}async function j(){for(A.value=!1,await E.eraseall_dms_execute();E.eraseall_status_dms.value<2;)await B(250);await B(250),M.value=!0}async function W(){A.value=!1,E.isConnected&&(await E.disconnect(),await B(250))}return(e,d)=>(l(),s("div",p,[d[14]||(d[14]=a('<h1 class="title">DUELink Loader</h1><p class="subtitle"> This page will help in updating DUELink firmware on a single module or on the entire chain of modules. </p><p class="subtitle"> If you are using MicroBlocks or Arduino on the first module in a chain, you need to update all modules first and then upload the first module with a different firmware. </p><img src="https://www.duelink.com/img/arduino-uno-r4-daisylinked.webp" alt="Chained modules" class="screenshot"><hr class="divider"><h2 class="section-title">Step 1 (Erase All)</h2><p class="subtitle"> Erase the module and enter DFU (Device Firmware Update) mode. </p><div class="card-container"><div class="card"><img src="https://www.duelink.com/img/catalog/mcduestem-b-1.webp" alt="Module with USB" class="card-image"><p class="card-text"> If your module has a USB connector, just plug it in! </p></div><div class="card"><img src="https://www.duelink.com/img/usbhook-rgb3.webp" alt="USB Hook" class="card-image"><p class="card-text"> If your module has a <code>U</code> Uplink connector, you need a USB adaptor, like USB Hook. </p></div></div><p class="subtitle"> Click the <strong>Erase All</strong> button, then select the device. You should only see one named <em>DUELink Official</em> or <em>DUELink MicroBlocks</em>. </p><img src="https://www.duelink.com/img/console-connect-dfu.webp" alt="Select DFU device" class="screenshot">',10)),t("div",v,[t("button",{class:"outline-button",onClick:d[0]||(d[0]=e=>x.value=!0)}," Erase All ")]),d[15]||(d[15]=a('<p class="subtitle"> If <strong>Erase All</strong> failed, visit the <a href="https://www.duelink.com/docs/loader" target="_blank"> loader documentation page </a>. </p><hr class="divider"><h2 class="section-title">Step 2 (Load Firmware)</h2><p class="subtitle"> This step will update the firmware on a single device, or on the first device in a chain. </p><p class="subtitle"> Click the button, then <strong>Connect</strong>. Select the <em>DFU in FS Mode</em> device. If using Windows, install the DFU driver first. </p><img src="https://www.duelink.com/img/console-connect-dfu.webp" alt="DFU selection" class="screenshot"><div class="button-row"><button class="outline-button"> Load DUELink Firmware </button></div><hr class="divider"><h2 class="section-title">Step 3 (Load Drivers)</h2><p class="subtitle"> This step will automatically detect the connected module and load the appropriate Driver Script. </p><p class="subtitle"> Click the <strong>Load Driver Script</strong> button, then select the device. You should only see one named <em>DUELink Official</em>. </p><img src="https://www.duelink.com/img/console-connect-dfu.webp" alt="Driver selection" class="screenshot"><div class="button-row"><button class="outline-button"> Load Driver Script </button></div>',13)),x.value?(l(),s("div",h,[t("div",w,[d[8]||(d[8]=t("div",{class:"dialog-title"},[t("i",{class:"fas fa-exclamation-triangle",style:{color:"yellow","margin-right":"8px"}}),o(" Warning ")],-1)),t("div",g,[1===T.value?(l(),s("p",b,[...d[3]||(d[3]=[o(" This feature only works on modules loaded with either DUELink official firmware or MicroBlocks firmware. It will completely erase the device and put it in DFU (Device Firmware Update) mode.",-1),t("br",null,null,-1),t("br",null,null,-1),o("Note: The following ",-1),t("strong",null,"Connect",-1),o(" window will be empty if the device is already in DFU mode or it has an uncompatible firmware, see ",-1),t("a",{target:"_blank",href:"https://www.duelink.com/docs/loader"},"Loader page",-1),o(". ",-1)])])):(l(),s("p",f,[d[4]||(d[4]=o(" This feature is only allowed on ",-1)),d[5]||(d[5]=t("strong",null,"Sel(1)",-1)),d[6]||(d[6]=o(", you have ",-1)),t("strong",null,"Sel("+n(T.value)+")",1),d[7]||(d[7]=o(". ",-1))]))]),t("div",k,[1===T.value?(l(),s("button",{key:0,class:"yes",onClick:Y}," Continue ")):i("",!0),t("button",{class:c(1===T.value?"no":"yes"),onClick:d[1]||(d[1]=e=>x.value=!1)}," Abort ",2)])])])):i("",!0),A.value?(l(),s("div",y,[t("div",U,[d[11]||(d[11]=t("div",{class:"dialog-title"},[t("i",{class:"fas fa-exclamation-triangle",style:{color:"yellow","margin-right":"8px"}}),o(" Warning ")],-1)),t("div",D,[t("p",null,[o(n(I.value),1),d[9]||(d[9]=t("br",null,null,-1)),d[10]||(d[10]=t("br",null,null,-1))])]),t("div",{class:"dialog-buttons"},[t("button",{class:"yes",onClick:j},"Yes"),t("button",{class:"no",onClick:W},"No")])])])):i("",!0),M.value?(l(),s("div",_,[t("div",C,[d[12]||(d[12]=t("div",{class:"dialog-title-success"},[t("i",{class:"fas fa-check-circle",style:{color:"green","margin-right":"8px"}}),o(" Success ")],-1)),d[13]||(d[13]=t("div",{class:"dialog-body"},[t("p",null,[o('"Erase All" operation completed. You are in DFU Mode now!'),t("br"),t("br"),o("Click the Connect button on the next window.")])],-1)),t("div",S,[t("button",{class:"no",onClick:d[2]||(d[2]=e=>{M.value=!1,r(E).isBusy=!1})},"Close")])])])):i("",!0)]))}}).mount("#app");
